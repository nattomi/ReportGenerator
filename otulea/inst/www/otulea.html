<html>
  <head>
    <title>OTULEA DEV</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
<%
## SETTINGS
%>
  </head>
  <body>
<!--  <p><a href="data/user/6CKBT">Show me</a> the raw XML data of the tests taken!</p>-->
  <form action="" method="POST">
      Select user:
<%
## option for selecting user
opts <- list.files(usersDir)
select <- newXMLNode("select", attrs=c(name="user"))
opts.XML <- lapply(opts,function(x)
            newXMLNode("option", attrs=c(id=x), x))
addChildren(select, opts.XML)
cat(saveXML(select),"<br>")
%>
  Select threshold:
<%
## option for selecting threshold
thresh <- seq(0,100,10)
select <- newXMLNode("select", attrs=c(name="threshold"))
thresh.XML <- lapply(thresh,function(x)
                         newXMLNode("option", attrs=c(id=paste("thresh",x,sep="_")), x))
addChildren(select, thresh.XML)
cat(saveXML(select),"<br>")
%>
  Limit result hits by:
<%
## option for limiting the number of results
maxlist <- seq(0,10,1)
select <- newXMLNode("select", attrs=c(name="maxlist"))
maxlist.XML <- lapply(maxlist,function(x)
                         newXMLNode("option", attrs=c(id=paste("maxlist",x,sep="_")), x))
addChildren(select, maxlist.XML)
cat(saveXML(select),"<br>")
%>

	  <input type="submit" value="Eval mode A" name="A" />
  </form>

<hr>

  <pre>
    <code>
<%
if (!is.null(POST)) { ## content of POST is NULL when the page is loaded for the first time and no eval button is pressed yet
## passing parameters HTML >> R
user <- as.character(POST$user)
threshold <- as.numeric(POST$threshold)
maxListings <- as.integer(POST$maxlist)
## the actual calculation 
ans <- getAlphalevels(user,threshold,maxListings)
print(ans)
}
## set selection (instead of falling back to default)
## using JavaScript here is a bit dirty, but I can't think of any better way
cat("<script type='text/javascript'>\n")
cat("document.getElementById('",POST$user,"').selected=true;\n",sep="")
cat("document.getElementById('",paste('thresh',POST$threshold,sep='_'),"').selected=true;\n",sep="")
cat("document.getElementById('",paste('maxlist',POST$maxlist,sep='_'),"').selected=true;\n",sep="")
cat("</script>\n")
%>
	 </code>
  </pre>
  </body>
</html>
